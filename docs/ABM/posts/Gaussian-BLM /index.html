<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.179">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Asael Alonzo Matamoros">
<meta name="dcterms.date" content="2022-12-12">

<title>asael_am - Capacidad de carros por consumo, parte 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">asael_am</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html">CV</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../ABM/index.html">Applied Bayesian Modeling</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../DOF/index.html">Depression and other stories</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/Asael_am"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/asael697"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/asael-alonzo-matamoros-8466836a/"><i class="bi bi-linkedin" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Capacidad de carros por consumo, parte 2</h1>
            <p class="subtitle lead">GLM Gaussianos revisitados</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Gaussian</div>
                <div class="quarto-category">code</div>
                <div class="quarto-category">analysis</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Asael Alonzo Matamoros </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 12, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#modelo-inicial" id="toc-modelo-inicial" class="nav-link active" data-scroll-target="#modelo-inicial">Modelo inicial</a></li>
  <li><a href="#modelo-completo-con-horseshoe-prior" id="toc-modelo-completo-con-horseshoe-prior" class="nav-link" data-scroll-target="#modelo-completo-con-horseshoe-prior">Modelo completo con Horseshoe prior</a></li>
  <li><a href="#modelo-gam-completo" id="toc-modelo-gam-completo" class="nav-link" data-scroll-target="#modelo-gam-completo">Modelo GAM completo</a></li>
  <li><a href="#leave-one-out-cross-validation" id="toc-leave-one-out-cross-validation" class="nav-link" data-scroll-target="#leave-one-out-cross-validation">Leave-One-Out-Cross-Validation</a></li>
  <li><a href="#referencias" id="toc-referencias" class="nav-link" data-scroll-target="#referencias">Referencias</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Este post presenta un análisis la base <code>mtcars</code> usando diferentes modelos Bayesianos</p>
<p>La base de datos <code>mtcars</code> contiene el registro de motores de carros mas populares en USA, 1974. los datos contienen 32 registros, con 10 atributos del motor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstanarm)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se desea predecir la capacidad de consumo de los motores, para eso se evaluaron las siguiente variables.</p>
<ul>
<li><p><code>mpg</code>: Millas por Galón. (<strong>Dependiente</strong>)</p></li>
<li><p><code>hp</code>: Caballos de fuerza.</p></li>
<li><p><code>carb</code>: número de carburadores.</p></li>
<li><p><code>wt</code>: peso del motor.</p></li>
<li><p><code>gears</code>: Número de cambios.</p></li>
<li><p><code>vs</code>: tipo de motor, <code>recto:1</code> o <code>tipo V:0</code>.</p></li>
<li><p><code>disp</code>: El desplazamiento.</p></li>
<li><p><code>am</code>: transmisión, <code>automático:0</code> o <code>manual:1</code>.</p></li>
<li><p><code>cyl</code>: número de cilindros.</p></li>
</ul>
<p>Todas las variables son numéricas, pero algunas son totalmente enteras, dificultando el proceso de análisis, se procede a revisar las correlaciones para revisar las interacciones lineales entre variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(mtcars[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">9</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pairs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-pairs-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Gráfico de pares. La diagonal principal muestra histogramas densidades de cada una de las variables. La parte superior muestra el coeficiente de correlación entre dos variables, fila y columna. La parte inferior muestra un gráfico de dispersión entre dos variables.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p><a href="#fig-pairs">Figure&nbsp;1</a> muestra colinealidad entre las variables <code>mpg, hp</code> y <code>wt</code>. Por lo tanto, múltiples modelos deben ser considerados.</p>
<section id="modelo-inicial" class="level2">
<h2 class="anchored" data-anchor-id="modelo-inicial">Modelo inicial</h2>
<p>Para medir la relación de consumo de los motores utilizaremos GLM normal reducido obtenido en el <a href="https://asael697.github.io/ABM/posts/Gaussian-LM/">post anterior, modelo M3</a>. Para las priors, elegimos de tipo débil estándar, por lo tanto el modelo final es:</p>
<p><span class="math display">mpg_i \sim N(\mu_i,\sigma^2), \quad  g(\mu_i) = \mu_i, \text{ y } \mu_i = \beta X_i.</span> <span class="math display">\mu_i = \beta_0 + \beta_1 wt+ \beta_2 gear + \beta_3 carb,</span> Con priors: <span class="math display">\beta_0 \sim \text{student-t}(4,0,10),</span> <span class="math display">\beta _{[1:3]}\sim N(0,5),</span> <span class="math display">\sigma \sim Cauchy_+(0,3).</span> El siguiente código corre un GLM Gaussiano, la sintaxis provista por el paquete <code>rstanarm</code> es bastante similar a la sintaxis de la librería estándar, con la diferencia de la especificación de las prior a utilizar; ademas, se debe especificar el numero de cadenas a correr <code>chains</code>, el numero de iteraciones por cadena <code>iter</code>, y el numero inicial de iteraciones a remover <code>warm.up</code>. En este caso utilizaremos los valores por defecto.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>bm1 <span class="ot">=</span> <span class="fu">stan_glm</span>(mpg<span class="sc">~</span>wt<span class="sc">+</span>gear<span class="sc">+</span>carb,<span class="at">data =</span> mtcars,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior_intercept =</span> <span class="fu">student_t</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior_aux =</span> <span class="fu">cauchy</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Info:
 function:     stan_glm
 family:       gaussian [identity]
 formula:      mpg ~ wt + gear + carb
 algorithm:    sampling
 sample:       4000 (posterior sample size)
 priors:       see help('prior_summary')
 observations: 32
 predictors:   4

Estimates:
              mean   sd   10%   50%   90%
(Intercept) 26.8    5.9 19.3  26.9  34.2 
wt          -3.3    0.9 -4.5  -3.3  -2.1 
gear         2.2    1.1  0.8   2.2   3.6 
carb        -1.5    0.5 -2.1  -1.5  -0.9 
sigma        2.8    0.4  2.3   2.8   3.3 

Fit Diagnostics:
           mean   sd   10%   50%   90%
mean_PPD 20.1    0.7 19.2  20.1  21.0 

The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).

MCMC diagnostics
              mcse Rhat n_eff
(Intercept)   0.1  1.0  1978 
wt            0.0  1.0  1920 
gear          0.0  1.0  2020 
carb          0.0  1.0  2032 
sigma         0.0  1.0  2392 
mean_PPD      0.0  1.0  3131 
log-posterior 0.1  1.0  1182 

For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</code></pre>
</div>
</div>
<p>El algoritmo por defecto utilizado en <code>Stan</code> es un MCMC, ver <span class="citation" data-cites="metropolis1953">Metropolis et al. (<a href="#ref-metropolis1953" role="doc-biblioref">1953</a>)</span> y <span class="citation" data-cites="betancourt2017">Betancourt (<a href="#ref-betancourt2017" role="doc-biblioref">2017</a>)</span>; y por lo tanto, es necesario revisar la convergencia de las cadenas simuladas. Los indicadores por defecto son:</p>
<ul>
<li><p><strong>Monte Carlo standard error</strong> (<code>mcse</code>): mide el error de la aproximación del estimador obtenido en métodos de Monte Carlo, y se calcula para la media <span class="math inline">E[\theta |y]</span>.</p></li>
<li><p><strong>Reducción de escala potencial, <span class="math inline">\hat R</span></strong> (<code>Rhat</code>): compara las varianzas promedio de las cadenas con las varianzas inter-cadenas, valores aproximados a uno indican convergencia.</p></li>
<li><p><strong>Effective sample size, ESS</strong> (<code>n_eff</code>): Estima el tamaño de muestra de los estimadores asumiendo independencia, Este valor debe ser cercan al total de iteraciones realizado después del <code>warm.up</code>.</p></li>
</ul>
<p>En nuestro modelo observamos que nuestros errores de M.C. son muy cercanos a cero, los <code>Rhat</code> son todos uno, y los ESS son todos la mitad del total de iteraciones. En general el modelo parece no tener problemas, los ESS están un poco bajo, y esto se puede solventar aumentando el número de iteraciones o incrementando el <code>warm.up</code>. Para efectos de este estudio aceptaremos las aproximaciones obtenidas.</p>
<p>Una de las ventajas de los métodos Bayesianos es que permite evaluar la incertidumbre de los estimadores de forma automática. El resultado del código anterior muestra los intervalos de credibilidad al 90%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_combo</span>(<span class="at">x =</span> bm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-post" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-post-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Graficos de las posteriors. la columna izquierda muesrta las densidades de cada uno de los parámetros. En la columna derecha se muestran los traceplots, que son las simlaciones de las diferentes cadenas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Es fácil visualizar las posteriors aproximadas mediante las cadenas obtenidas. <a href="#fig-post">Figure&nbsp;2</a> muestra los gráficos de densidad para cada uno de los parámetros y en la columna derecha muestra las cadenas simuladas, las cuales se han mezclado y lucen estacionarias, indicando convergencia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(bm1)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior predictive cheks, M1"</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">subtitle =</span> <span class="st">"Overlayed densities"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ppc" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-ppc-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;3: Gráfico de densidades sobrepuestos. Se comparan una muestra de la densidad predictiva <em>yrep</em> con la muestra de los datos <em>y</em> mediante densidades. Las densidades esta sobrepuestas muestran un buen ajuste del modelo.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Finalmente, revisamos el ajusto del modelo, para eso usamos posterior predictive checks, la idea es comparar la distribución de la densidad predictiva del modelo con la densidad aproximada de la muestra. <a href="#fig-ppc">Figure&nbsp;3</a> muestra la comparación de ambas densidades, ilustrando un buen ajuste del modelo.</p>
</section>
<section id="modelo-completo-con-horseshoe-prior" class="level2">
<h2 class="anchored" data-anchor-id="modelo-completo-con-horseshoe-prior">Modelo completo con Horseshoe prior</h2>
<p>El nuevo modelo a considerar es un GLM Gaussiano, agregando mas covariables y utilizando un prior regularizadora de <code>Horseshoe</code> para las covariables. Por lo tanto el modelo es:</p>
<p><span class="math display">M_2: \ mpg_i \sim N(\mu_i,\sigma^2), \quad  g(\mu_i) = \mu_i, \text{ y } \mu_i = \beta X_i.</span> <span class="math display">\mu_i = \beta_0 + \beta_1 wt+ \beta_2 gear + \beta_3 carb + \beta_4 vs +\beta5 cyl +\beta_6 am,</span> Con priors: <span class="math display">\beta_0 \sim \text{student-t}(4,0,10),</span> <span class="math display">\sigma \sim Cauchy_+(0,3),</span> <span class="math display">\beta _{[1:6]}\sim N(0,\tau^2 _{[1:6]} \sigma^2_\beta),</span> <span class="math display">\tau^2 _{[1:6]} \sim Cauchy_+(0,1); \quad E[\sigma^2_\beta] = 0.01, \ V[\sigma^2_\beta] = 4.</span> En este caso los valores globales <code>df</code> y <code>scale</code>, son hiper-parámetros que “regularizan” la <code>Horseshoe</code> prior a través de sus primeros dos momentos, para un mejor ajuste. El siguiente código presenta el modelo <span class="math inline">M_2</span>. Debido a problemas de convergencia del modelo, es necesario aumentar <code>adapt_delta</code> de NUTS para un mejor salto en el HMC.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>bm2 <span class="ot">=</span> <span class="fu">stan_glm</span>(mpg<span class="sc">~</span>wt<span class="sc">+</span>gear<span class="sc">+</span>carb<span class="sc">+</span>vs<span class="sc">+</span>cyl<span class="sc">+</span>am,<span class="at">data =</span> mtcars,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior =</span> <span class="fu">hs</span>(<span class="at">df =</span> <span class="dv">1</span>,<span class="at">global_df =</span> <span class="dv">4</span>,<span class="at">global_scale =</span> <span class="fl">0.01</span>),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior_intercept =</span> <span class="fu">student_t</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior_aux =</span> <span class="fu">cauchy</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">refresh =</span> <span class="dv">0</span>,<span class="at">adapt_delta =</span> <span class="fl">0.99</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Info:
 function:     stan_glm
 family:       gaussian [identity]
 formula:      mpg ~ wt + gear + carb + vs + cyl + am
 algorithm:    sampling
 sample:       4000 (posterior sample size)
 priors:       see help('prior_summary')
 observations: 32
 predictors:   7

Estimates:
              mean   sd   10%   50%   90%
(Intercept) 38.1    2.7 34.9  38.3  41.3 
wt          -2.9    1.4 -4.6  -3.0  -0.7 
gear         0.0    0.3 -0.1   0.0   0.2 
carb        -0.1    0.3 -0.5   0.0   0.0 
vs           0.1    0.5 -0.1   0.0   0.3 
cyl         -1.4    0.8 -2.4  -1.4  -0.1 
am           0.1    0.4 -0.1   0.0   0.3 
sigma        2.8    0.4  2.3   2.8   3.4 

Fit Diagnostics:
           mean   sd   10%   50%   90%
mean_PPD 20.1    0.7 19.2  20.1  21.0 

The mean_ppd is the sample average posterior predictive distribution of the outcome variable (for details see help('summary.stanreg')).

MCMC diagnostics
              mcse Rhat n_eff
(Intercept)   0.1  1.0  1535 
wt            0.1  1.0   531 
gear          0.0  1.0  3022 
carb          0.0  1.0  2122 
vs            0.0  1.0  1229 
cyl           0.0  1.0   602 
am            0.0  1.0  2533 
sigma         0.0  1.0  1203 
mean_PPD      0.0  1.0  3862 
log-posterior 0.1  1.0   759 

For each parameter, mcse is Monte Carlo standard error, n_eff is a crude measure of effective sample size, and Rhat is the potential scale reduction factor on split chains (at convergence Rhat=1).</code></pre>
</div>
</div>
<p>Los indicadores convergencia parecen bien excepto para los coeficientes <code>wt</code> y <code>cyl</code> que son los valores no nulos del modelo, que debido a ser valores atípicos y que este tipo de priors fuerzan a cero los coeficientes, es natural que el HMC tenga problemas para explorar la posterior de estos parámetros.</p>
<div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_combo</span>(<span class="at">x =</span> bm2,<span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"gear"</span>,<span class="st">"carb"</span>,<span class="st">"cyl"</span>,<span class="st">"wt"</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>rstanarm<span class="sc">::</span><span class="fu">pp_check</span>(bm2)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior predictive cheks, M2-Horeshoe"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">subtitle =</span> <span class="st">"Overlayed densities"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-diag2" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-diag2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-diag2-1.png" class="img-fluid figure-img" data-ref-parent="fig-diag2" width="672"></p>
<p></p><figcaption class="figure-caption">(a) Gráfico para las posteriors y traceplots de los parámetros nulos.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-diag2-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-diag2-2.png" class="img-fluid figure-img" data-ref-parent="fig-diag2" width="672"></p>
<p></p><figcaption class="figure-caption">(b) Posterior predictive checks: densidades sobre-puestas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: Graficos de diagnósticos para el modelo completo con prior regularizadora de Horseshoe. Se presetan las densidades y traceplots de dos parametros con posteriors regularizadas (Nulas), y dos posteriors significativas. El gráfico derecho es un diagnóstico del ajuste del modelo usando densidades sobre-puestas; comparando una muestra de la densidad predictiva <em>yrep</em> con la muestra de los datos <em>y</em></figcaption><p></p>
</figure>
</div>
</div>
<p><a href="#fig-diag2">Figure&nbsp;4</a> parte (a) muestra las posteriors y traceplots para dos parámetros nulos (<code>gear</code> y <code>carb</code>) y dos parámetros significativos (<code>cyl</code> y <code>wt</code>). Los coeficientes nulos tienen posteriors con colas muy pesadas como se esperaba, pero los otros dos coeficientes tiene posteriors multi-modales indicando problemas de identificación u convergencia, para descartar el segundo problema se recomienda correr un mayor número de iteraciones. La parte (b) muestra el ajuste del modelo, que se observa un mejor ajuste que el modelo anterior.</p>
</section>
<section id="modelo-gam-completo" class="level2">
<h2 class="anchored" data-anchor-id="modelo-gam-completo">Modelo GAM completo</h2>
<p><span class="math display">M_3: \ mpg_i \sim N(\mu_i,\sigma^2), \quad  g(\mu_i) = \mu_i,\ \text{y } \mu_i = f_1(x_i)+f_2(hp_i)+f_3(disp_i),</span> donde:</p>
<p><span class="math display">f_1(x_i) = \beta_0 + \beta_1 wt+ \beta_2 gear + \beta_3 carb + \beta_4 vs +\beta_5 cyl +\beta_6 am,</span> <span class="math display">f_2(hp_i) = \sum_{s=1}^{10}\beta_s b_s(hp), \ y \ f_3(disp_i) = \sum_{s=1}^{10}\beta_s b_s(disp).</span> Con priors:</p>
<p><span class="math display">\beta_0 \sim \text{student-t}(4,0,10),</span> <span class="math display">\beta _{[1:26]}\sim N(0,5),</span> <span class="math display">\sigma \sim Cauchy_+(0,3).</span> El siguiente código presenta el modelo <span class="math inline">M_3</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>bm3 <span class="ot">=</span> <span class="fu">stan_gamm4</span>(mpg<span class="sc">~</span>wt<span class="sc">+</span>gear<span class="sc">+</span>carb<span class="sc">+</span>vs<span class="sc">+</span>cyl<span class="sc">+</span>am<span class="sc">+</span><span class="fu">s</span>(hp)<span class="sc">+</span><span class="fu">s</span>(disp),<span class="at">data =</span> mtcars,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior =</span> <span class="fu">normal</span>(<span class="dv">0</span>,<span class="dv">5</span>),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior_intercept =</span> <span class="fu">student_t</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior_aux =</span> <span class="fu">cauchy</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">refresh =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dado que el numero de parámetros registrado es muy grande no presentaremos el resumen del modelo. Con respecto al diagnóstico de la aproximación MCMC, presentamos valores máximos, el mayor <code>mcse</code> fue de 0.2, todos los <code>Rhat</code> fueron igual a uno; y el menor <code>ess</code> fue de 1,224 iteraciones. Por lo tanto, aceptamos la aproximación obtenida.</p>
<div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_combo</span>(<span class="at">x =</span> bm3,<span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"gear"</span>,<span class="st">"carb"</span>,<span class="st">"cyl"</span>,<span class="st">"wt"</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>rstanarm<span class="sc">::</span><span class="fu">pp_check</span>(bm3)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Posterior predictive cheks, M3-GAM"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">subtitle =</span> <span class="st">"Overlayed densities"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-diag3" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-diag3-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-diag3-1.png" class="img-fluid figure-img" data-ref-parent="fig-diag3" width="672"></p>
<p></p><figcaption class="figure-caption">(a) Gráfico para las posteriors y traceplots de los parámetros nulos.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-diag3-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-diag3-2.png" class="img-fluid figure-img" data-ref-parent="fig-diag3" width="672"></p>
<p></p><figcaption class="figure-caption">(b) Posterior predictive checks: densidades sobre-puestas.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;5: Graficos de diagnósticos para el modelo completo con prior regularizadora de Horseshoe. Se presetan las densidades y traceplots de los parametros lineales. El gráfico derecho es un diagnóstico del ajuste del modelo usando densidades sobre-puestas; comparando una muestra de la densidad predictiva <em>yrep</em> con la muestra de los datos <em>y</em></figcaption><p></p>
</figure>
</div>
</div>
<p><a href="#fig-diag3">Figure&nbsp;5</a> muestra las densidades y traceplots para todos los parámetros lineales, donde observamos convergencia y densidades unimodales. La parte derecha muestra el ajuste del modelo, con densidades sobre-puestas presentando un buen ajuste del modelo <span class="math inline">M_3</span>. <a href="#fig-nl">Figure&nbsp;6</a> muestra los efectos no lineales marginales del modelo para las covariables <code>hp</code> y <code>disp</code>. Los efectos marginales son suaves y casi constantes, indicando que el aporte no lineal es muy poco.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_nonlinear</span>(bm3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-nl" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-nl-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;6: Efectos marginales no lineales. Estos graficos presentan las relacionnes no lineales de las variables designadas con los datos.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="leave-one-out-cross-validation" class="level2">
<h2 class="anchored" data-anchor-id="leave-one-out-cross-validation">Leave-One-Out-Cross-Validation</h2>
<p>Para evaluar el aprendizaje de cada modelo estimaremos la expected log-predictive density (<code>elpd</code>) de cada modelo usando <code>LOO</code>, <span class="citation" data-cites="vehtari2016">Vehtari et al. (<a href="#ref-vehtari2016" role="doc-biblioref">2015</a>)</span>, los modelos que consideraremos son cuatro:</p>
<ul>
<li><p><span class="math inline">M_1:</span> Modelo Gaussiano reducido.</p></li>
<li><p><span class="math inline">M_2:</span> Modelo Gaussiano completo, <code>Horseshoe</code> prior.</p></li>
<li><p><span class="math inline">M_3:</span> Modelo Generalizado aditivo Gaussiano completo</p></li>
<li><p><span class="math inline">M_4:</span> Modelo Gaussiano completo, <code>LASSO</code> prior.</p></li>
</ul>
<p>El siguiente código muestra del modelo <span class="math inline">M_4</span> con un prior regularizadora de tipo LASSO. Con respecto al ajuste, el mayor <code>mcse</code> fue de 0.1. Todos los <code>Rhat</code> fueron igual a uno, y el menor <code>ess</code> fue de 1,230 iteraciones. A diferencia del modelo <code>Horseshoe</code> (<span class="math inline">M_3</span>), este modelo no encontró covariables nulas, todas las variables aportan algo al modelo, por lo tanto falla en regularizar los parámetros.</p>
<p><strong>Importante:</strong> Que este modelo no regularice no implica que falle o es incorrecto. Este fenómeno se debe a que la prior <code>LASSO</code> tiene colas menos pesadas que la <code>Horseshoe</code> y por ende es más flexible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>bm4 <span class="ot">=</span> <span class="fu">stan_glm</span>(mpg<span class="sc">~</span>wt<span class="sc">+</span>gear<span class="sc">+</span>carb<span class="sc">+</span>vs<span class="sc">+</span>cyl<span class="sc">+</span>am,<span class="at">data =</span> mtcars,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior =</span> <span class="fu">lasso</span>(<span class="at">df =</span> <span class="dv">1</span>,<span class="at">location =</span> <span class="dv">0</span>,<span class="at">autoscale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior_intercept =</span> <span class="fu">student_t</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior_aux =</span> <span class="fu">cauchy</span>(<span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">refresh =</span> <span class="dv">0</span>,<span class="at">adapt_delta =</span> <span class="fl">0.99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ajustamos <code>LOO</code> para cada uno del modelo aproximando la <code>elpd</code> con muestreo por importancia de tipo Pareto (<code>PISIS</code>), en caso que una de las observaciones <code>PISIS</code> no converja (<span class="math inline">\hat k \geq 0.7</span>), esta será calculada re ajustando el modelo nuevamente solamente en esa observación.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>loo1 <span class="ot">=</span> <span class="fu">loo</span>(bm1,<span class="at">k_threshold =</span> <span class="fl">0.7</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>loo2 <span class="ot">=</span> <span class="fu">loo</span>(bm2,<span class="at">k_threshold =</span> <span class="fl">0.7</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>loo3 <span class="ot">=</span> <span class="fu">loo</span>(bm3,<span class="at">k_threshold =</span> <span class="fl">0.7</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>loo4 <span class="ot">=</span> <span class="fu">loo</span>(bm4,<span class="at">k_threshold =</span> <span class="fl">0.7</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(loo1,loo2,loo3,loo4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    elpd_diff se_diff
bm4  0.0       0.0   
bm3 -0.7       1.2   
bm2 -1.0       1.7   
bm1 -1.5       2.9   </code></pre>
</div>
</div>
<p>Los resultados muestran que el mejor modelo es el modelo aditivo Generalizado (GAM) completo <span class="math inline">M_3</span> indicando que los efectos no lineales si influyen en el ajuste y predicción del modelo.</p>
</section>
<section id="referencias" class="level2">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">Referencias</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-betancourt2017" class="csl-entry" role="doc-biblioentry">
Betancourt, Michael. 2017. <span>“A Conceptual Introduction to Hamiltonian Monte Carlo.”</span> <a href="https://arxiv.org/abs/1701.02434">https://arxiv.org/abs/1701.02434</a>.
</div>
<div id="ref-Casella" class="csl-entry" role="doc-biblioentry">
Casella, George, and Roger Berger. 2001. <em>Statistical Inference</em>. Duxbury Resource Center. <a href="http://www.amazon.fr/exec/obidos/ASIN/0534243126/citeulike04-21">http://www.amazon.fr/exec/obidos/ASIN/0534243126/citeulike04-21</a>.
</div>
<div id="ref-degroot2012" class="csl-entry" role="doc-biblioentry">
DeGroot, M. H., and M. J. Schervish. 2012. <em>Probability and Statistics</em>. Addison-Wesley. <a href="https://books.google.es/books?id=4TlEPgAACAAJ">https://books.google.es/books?id=4TlEPgAACAAJ</a>.
</div>
<div id="ref-gelman2013" class="csl-entry" role="doc-biblioentry">
Gelman, A., J. B. Carlin, H. S. Stern, D. B. Dunson, A. Vehtari, and D. B. Rubin. 2013. <em>Bayesian Data Analysis, Third Edition</em>. Chapman &amp; Hall/CRC Texts in Statistical Science. Taylor &amp; Francis. <a href="https://books.google.nl/books?id=ZXL6AQAAQBAJ">https://books.google.nl/books?id=ZXL6AQAAQBAJ</a>.
</div>
<div id="ref-gelman2020bayesian" class="csl-entry" role="doc-biblioentry">
Gelman, Andrew, Aki Vehtari, Daniel Simpson, Charles C. Margossian, Bob Carpenter, Yuling Yao, Lauren Kennedy, Jonah Gabry, Paul-Christian Bürkner, and Martin Modrák. 2020. <span>“Bayesian Workflow.”</span> <a href="https://arxiv.org/abs/2011.01808">https://arxiv.org/abs/2011.01808</a>.
</div>
<div id="ref-BMCP2021" class="csl-entry" role="doc-biblioentry">
Martin, Osvaldo A., Ravin Kumar, and Junpeng Lao. 2021. <em><span class="nocase">Bayesian Modeling and Computation in Python</span></em>. <span>Boca Raton</span>.
</div>
<div id="ref-metropolis1953" class="csl-entry" role="doc-biblioentry">
Metropolis, Nicholas, Arianna W. Rosenbluth, Marshall N. Rosenbluth, Augusta H. Teller, and Edward Teller. 1953. <span>“Equation of State Calculations by Fast Computing Machines.”</span> <em>The Journal of Chemical Physics</em> 21 (6): 1087–92. <a href="https://doi.org/10.1063/1.1699114">https://doi.org/10.1063/1.1699114</a>.
</div>
<div id="ref-Miggon2014" class="csl-entry" role="doc-biblioentry">
Migon, Helio, Dani Gamerman, and Francisco Louzada. 2014. <em>Statistical Inference. An Integrated Approach</em>. Chapman and Hall CRC Texts in Statistical Science. Chapman; Hall.
</div>
<div id="ref-BMLR2021" class="csl-entry" role="doc-biblioentry">
Roback, paul., and Julie. Legler. 2021. <em><span class="nocase">Beyond Multiple Linear Regression: Applied Generalized Linear Models an Multilevel Models in R</span></em>. <span>Boca Raton</span>.
</div>
<div id="ref-vehtari2016" class="csl-entry" role="doc-biblioentry">
Vehtari, Aki, Daniel Simpson, Andrew Gelman, Yuling Yao, and Jonah Gabry. 2015. <span>“Pareto Smoothed Importance Sampling.”</span> <a href="https://arxiv.org/abs/1507.02646">https://arxiv.org/abs/1507.02646</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>